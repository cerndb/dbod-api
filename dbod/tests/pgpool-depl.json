{
  "apiVersion": "extensions/v1beta1",
  "kind": "Deployment",
  "metadata": {
    "name": "pgpool-depl"
  },
  "spec": {
    "replicas": 1,
    "template": {
      "metadata": {
        "labels": {
          "app": "pgpool01"
        }
      },
      "spec": {
        "containers": [
          {
            "env": [
              {
                "name": "PGPOOL_BACKENDS",
                "value": "0:dbod-pgm01.cern.ch:6600:/ORA/dbs03/PGM01/data,1:dbod-pgs01.cern.ch:6600:/ORA/dbs03/PGS01/data"
              }
            ],
            "image": "gitlab-registry.cern.ch/db/dbod-pgpool:3.5.4.1",
            "imagePullPolicy": "Always",
            "name": "pgpool-cont",
            "ports": [
              {
                "containerPort": 5432,
                "name": "p0"
              },
              {
                "containerPort": 9898,
                "name": "p1"
              }
            ],
            "volumeMounts": [
              {
                "mountPath": "/etc/ssl/private",
                "name": "secret-ssl",
                "readOnly": true
              },
              {
                "mountPath": "/etc/kerberos",
                "name": "secret-kerberos"
              },
              {
                "mountPath": "/secrets",
                "name": "secret-userpass",
                "readOnly": true
              }
            ]
          }
        ],
        "imagePullSecrets": [
          {
            "name": "gitlab-registry"
          }
        ],
        "volumes": [
          {
            "name": "secret-ssl",
            "secret": {
              "secretName": "pgpool-ssl"
            }
          },
          {
            "name": "secret-kerberos",
            "secret": {
              "secretName": "pgpool-kerberos"
            }
          },
          {
            "name": "secret-userpass",
            "secret": {
              "secretName": "pgpool-userpass"
            }
          }
        ]
      }
    }
  }
}
